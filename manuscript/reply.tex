\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{natbib}
\usepackage{listings}
\usepackage{rotating, graphicx}
\usepackage{booktabs, natbib}
\usepackage{breakurl}
% \usepackage [english]{babel}
\usepackage{amsmath, amsbsy, amsthm, epsfig, epsf, psfrag, graphicx,
  amssymb, enumerate}

\usepackage{enumitem}

\usepackage{color}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\pkg}[1]{{\fontseries{b}\selectfont #1}}
\newcommand\code{\bgroup\@makeother\_\@makeother\~\@makeother\$\@codex}
\def\@codex#1{{\normalfont\ttfamily\hyphenchar\font=-1 #1}\egroup}

\usepackage[colorlinks=true, urlcolor=blue, linkcolor=blue, citecolor=blue]{hyperref}

% \usepackage{csquotes}
% \usepackage [autostyle, english = american]{csquotes}
% \MakeOuterQuote{"}

% \usepackage{bibentry}

% \usepackage{xr}
% \externaldocument{ofex-full}
% \externaldocument{supp}

\newenvironment{comment}%
{\begin{quotation}\noindent\small\it\ignorespaces%
  }{\end{quotation}}


\begin{document}

\begin{center}
  {\Large\bf Response to the Comments}
\end{center}

\section*{Summary}

We thank the two reviewers for carefully reviewing the manuscript and
providing their detailed, constructive comments.
The manuscript has been largely revised to incorporate these comments.
A summary of the major changes is as follows.

\begin{enumerate}
\item to be added
\end{enumerate}

Point-by-point responses are as follows, with the original comments
quoted in smaller, italic font.


\subsection*{To Reviewer 1}

\begin{comment}
  The authors provide a comprehensive R package for the numerical computation of
Wilcoxon-Mann-Whitney-type tests for clustered data, that is when the classical
assumption of independent data across the two groups is violated and units may be
observed more than once. The package is freely available on CRAN.
\end{comment}
Thank you for this precise summary of our work.

\begin{comment}
The paper is very well written and provides a comprehensive overview of existing
methods. Indeed, clustered data occur frequently in applications and I have used the
R package for data analysis before. The package is very user-friendly and easy to
use both in data analysis and teaching purposes. However, few remarks remain and I
hope that these may help to improve the paper.
\end{comment}

Thank you for being appreciate of the paper and the package. We address each
remark point-by-point in the following.

\begin{comment}
Throughout the paper the authors write the null hypothesis and alternative in
terms of differences in location. I wonder if the correction formulation wouldn't
be "differences in distribution".
\end{comment}

The Wilcoxon rank-sum test is used for testing whether observations in one
population tend to be larger than observations in the other. And the
Wilcoxon signed-rank test is used for testing whether the difference scores
are symmetric about zero or another value. In essence both are testing the
central tendency of the distribution regardless of the shape of the
distributions, e.g., the RGL rank-sum test has no power when comparing data
from an $N(0, 1)$ distribution and data from an $N(0, 2)$
distribution. Moreover, the \texttt{wilcox.text} in the \pkg{stats} package
has an output which put the alternative hypothesis as there is a location
shift. Our test is essentially a generalization of the ordinal Wilcoxon
tests, therefore we follow the same style as the \texttt{wilcox.test}.

\begin{comment}
Regarding comment 1: The output of the functions also say "alternative
hypothesis: true difference in locations is not equal to 0". The distributions are
not identical or something similar.
\end{comment}

See reply for the last comment.

\begin{comment}
The illustrative data generating functions would greatly benefit if other
distributions than normal could be generated.
\end{comment}

The data generating function in the paper actually generates log-normal
distribution, which is skewed distribution. The heaviness of its tail can
also be tuned by choosing different scale parameter. Since one advantage of
using a non-parametric test is that it works for non-normal data, so we have
this in our mind when we design the data generating function.

\begin{comment}
The authors added a simulation study that compares the RGL method with the
DS method in Section 6. I wonder why a paper that should demonstrate the
usage of a software benefits from that comparison. I would suggest moving
that Section to the appendix. Furthermore, how do the methods compare
under skewed distributions or ties?
\end{comment}
Thanks for this suggestion. We have put the simulation into the appendix.
For skewed distribution, since the simulated data have a log-normal
distribution, the result in Table 2 in the paper is already a comparison.
All methods can deal with ties. Nevertheless, the data property that may
induce significant difference among this method should be the way the data
are clustered, e.g., whether distribution of group within each cluster is
related to cluster size, or whether different clusters have different
correlation structure. These points are partly illustrated in the simulation
done by \citet{Datt:Satt:rank:2005} and \citet{Datt:Satt:sign:2008}.

\subsection*{To Reviewer 2}

\begin{comment}
The clusrank package implements Wilcoxon Rank-based tests for clustered
data. It takes the latest references regarding this topic and implements
them in a unified user- friendly interface. Particularly, the authors
implement both Wilcoxon rank-sum and signed-rank tests and they divide
them in two methods: (i) RGL for those by Rosner, Glynn, and Lee; and (ii)
DS for those by Datta and Satten.  The authors provide a review of the
proposed methodology, a case study in the ophthal- mological field and a
simulation scenario in order to compare the two proposed methods.
\end{comment}

Thank you for the comprehensive and precise summary.

\begin{comment}
I have two main concerns regarding this paper. The first one is that, in
the introduction section, another package (\texttt{ClusterRankTest}) is
mentioned which implements the DS methods. It is not clear to me what the
differences are between both... Would there be any advantage if I used the
\texttt{clusrank} with method = "ds"?
\end{comment}

Since the implemented test is the same, the output should be the
same. One difference may be that our function should be faster, since we put
some computationally heavy steps into C++ code while they solely used R.

\begin{comment}
And the other important question is if this package, which includes only one function
with two methods (and I think that one of them is equal to the one implemented in the
\texttt{ClusterRankTest} package), is really enough to be published in this journal. Maybe it
would be better to include first, in a new version of the package, some of the future tasks
that are mentioned in the conclusion section in order to improve its functionality (for exam-
ple , ``...implementation of other rank-based methods for clustered data can be considered
in future development of the package clusrank" or ``...when covariates are available, rank
regression for clustered data")
\end{comment}

Sorry Prof. Yan, I don't know how to answer this one.

\begin{comment}
Page 2, line 13: ``Unlike rank-based procedures, however, it is not
invariant to monotonic transformations of the data". I miss some
references here.
\end{comment}

Using GEE to compare two groups can be done by adding an indicator of the
group membership to the covariants of the expected observation and
estimating the corresponding coefficient. The estimation of a GEE is solving a set
of score equations , therefore transforming the data values will induce
change in the estimates and may lead to different conclusions.

\begin{comment}
Page 3, line 16-17: ``...which are made very easy by the package using only a few
lines of codes". I think that this is not very important to mention it in this part.
\end{comment}

Thanks for pointing this out. We have removed it.

\begin{comment}
Page 9, line 9: ``parid difference" I guess ``paired"
\end{comment}

Thanks for pointing out this typo. We have corrected it.

\begin{comment}
Page 9, second paragraph: I had to read the help file of the package in
order to understand clearer this functionality.
I would like to see a new version of this paragraph.
I propose to mention first ``exact = TRUE", the you must talk about ``B = 0" and
then ``B = 2000".
\end{comment}

We have rewritten this passage to make it more readable.

\begin{comment}
Page 11, line 6: ``Setting method = ``ds" would perform the DS test". Put this
sentence below when you are using the method.
\end{comment}

We have moved it to a more suitable place, right before using the method.

\begin{comment}
Page 11, line 17: ``... with a small number of clusters..." Could you give a recom-
mendation of the number?
\end{comment}

Added in the manuscript.

\begin{comment}
Page 12, second paragraph: Include ``?methods (using the asymptotic theory) are
very?"
\end{comment}

We have added this sentence into the manuscript.

\begin{comment}
Page 12, last line: The DS method can compare more than two groups. We illustrate
this by assigning 4 groups to this data... What happens if you use the RGL method?
maybe a warning would be useful!
\end{comment}

Thanks for this suggestion. We have added a warning to remind the user about
this point in the package.

\begin{comment}
Page 13, R code, last line: you have to introduce and extra space here? it was
changed in the current version!
\end{comment}

Prof. Yan I couldn't find out the space he mentioned.

\begin{comment}

Page 16, line 5: ``The results suggest association between the presence of CFH
R1210C rare variant and the symptom with CNV as the advanced stage." for what
alpha?? one pvalue is 0.006312 and the other is 0.06404...
\end{comment}

We tried to avoid giving a specific conclusion here since if we set the
alpha as one of the commonly used values, 0.01 or 0.05, these two tests will
give contradictory conclusions, though both p-values are reasonably small,
which implies association to some degree between the presence of CFH R1210C
rare variant and the symptom with CNV as the advanced stage.

\begin{comment}
Additionally, I would like to see a help file for the package (?clusrank)
where you can find some description.
Additionally, if a click on index I do not see the amd link to the dataset.
\end{comment}

Have fixed in the updated package.

\bibliographystyle{Chicago}
\bibliography{clusrank}

\end{document}
